<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>microBlock IDE</title>
        <meta name="description" content="Program a microcontroller with Block & MicroPython, Use without install and Free !">
        <meta name="theme-color" content="#F1C40F" />
        <link rel="icon" href="favicon.ico" sizes="64x64">
        <link rel="manifest" href="manifest.json">

        <script>
        const isElectron = navigator.userAgent.toLowerCase().indexOf("electron/") >= 0;
        </script>

        <!-- Blockly -->
        <script src="blockly/blockly_compressed.js"></script>
        <script src="blockly/blocks_compressed.js"></script>
        <script src="blockly/python_compressed.js"></script>
        <script src="blockly/msg/js/en.js"></script>

        <!-- Overwrite some Blockly file -->
        <script src="blockly/blocks/procedures.js"></script>

        <!-- Insert this line above script imports  -->
        <script>
        if (typeof module === 'object') {
            window.module = module; 
            module = undefined;
        }
        </script>

        <!-- jQuery -->
        <script src="js/jquery-3.5.1.min.js"></script>

        <!-- Insert this line after script imports -->
        <script>if (window.module) module = window.module;</script>

        <!-- Notiflix -->
        <link rel="stylesheet" href="notiflix/notiflix-2.3.3.min.css">
        <script src="notiflix/notiflix-2.3.3.min.js"></script>

        <!-- Tippy.js -->
        <script src="tippyjs/popper.min.js"></script>
        <script src="tippyjs/tippy-bundle.umd.min.js"></script>

        <!-- term.js -->
        <!-- <script src="term.js/src/term.js"></script> -->

        <!-- xterm.js -->
        <link rel="stylesheet" href="xterm.js/xterm.css">
        <script src="xterm.js/xterm.js"></script>
        <script src="xterm.js/xterm-addon-fit.js"></script>

        <!-- Monaco -->
        <link rel="stylesheet" href="monaco-editor/min/vs/editor/editor.main.css">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="fontawesome/css/all.min.css">

        <!-- Animate.css -->
        <link rel="stylesheet" href="css/animate.min.css">

        <link rel="stylesheet" href="css/style.css">

        
    </head>

    <body>
        <section class="page">
            <article class="main">
                <header>
                    <div class="left">
                        <div class="header-logo animate__animated animate__bounceInLeft">microBlock</div>
                    </div>
                    <div class="center">
                        <ul class="switch-mode" id="mode-select-switch">
                            <li data-value="1" data-tippy-content="Switch to Block mode" class="active">Block</li>
                            <li data-value="2" data-tippy-content="Switch to Code mode">Code</li>
                        </ul>
                    </div>
                    <div class="right">
                        <ul class="top-bar-button">
                            <li><button id="install-pwa" style="display: none;" onclick="installPWA()" data-tippy-content="Install microBlock to your PC"><i class="fas fa-download"></i></button></li>
                            <li><button id="open-extension-dialog" data-tippy-content="Extension"><i class="fas fa-cubes"></i></button></li>
                            <li><button id="open-help" data-tippy-content="Help"><i class="fas fa-question"></i></button></li>
                            <li><button id="github-signin" data-tippy-content="Sign in with GihHub"><i class="fab fa-github"></i></button></li>
                            <li><img id="github_avatar" src="" alt="GitHub Avatar"></li>
                        </ul>
                    </div>
                </header>
                <section id="blocks-editor">
                    <!-- <section class="block-category">
                        <ul id="blockCategoryList"> -->
                            <!--
                            <li>
                                <div class="icon"></div>
                                <div class="label"></div>
                            </li>
                            -->
                        <!-- </ul>
                    </section> -->
                    <section class="work-box">
                        <div id="blocklyArea"></div>
                        <div id="blocklyDiv" style="position: absolute;"></div>
                    </section>
                </section>
                <section id="code-editor">
                    <article></article>
                </section>
                <footer>
                    <div class="control-box">
                        <ul class="button-list left">
                            <li><button id="new-project" data-tippy-content="New project"><i class="far fa-file"></i></button></li>
                            <li><input type="text" id="project-name" value="myProject" placeholder="Project Name"></li>
                            <li><button id="save-project" data-tippy-content="Save project"><i class="far fa-save"></i></button></li>
                            <li><button id="open-project" data-tippy-content="Open project"><i class="far fa-folder-open"></i></button></li>
                            <li><button id="open-github-dialog" data-tippy-content="GitHub Manager"><i class="fab fa-github"></i></button></li>
                        </ul>
                        <ul class="button-list center">
                            <li><button id="upload-program" data-tippy-content="Upload" class="zoom"><i class="fas fa-upload"></i></button></li>
                        </ul>
                        <ul class="button-list right">
                            <li><button id="open-terminal" data-tippy-content="Open Terminal"><i class="fas fa-terminal"></i></button></li>
                        </ul>
                    </div>
                </footer>
            </article>

            <!-- Right Terminal -->
            <article id="terminal">
                <header>
                    <div class="title">Terminal</div>
                    <div class="icon">
                        <button id="connect-device" data-tippy-content="Connect"><i class="fas fa-link"></i></button>
                        <button id="clear-terminal" data-tippy-content="Clear"><i class="fas fa-eraser"></i></button>
                        <button id="resize-terminal" data-tippy-content="Resize"><i class="fas fa-expand-alt"></i></button>
                        <button id="close-terminal" data-tippy-content="Close"><i class="fas fa-times"></i></button>
                    </div>
                </header>
                <section contenteditable="true"></section>
            </article>

        </section>

        <article id="terminal-h-resize"></article>

        <div id="dialog-backdrop"></div>

        <div class="dialog" id="extension-dialog">
            <header>
                <div class="title">Extension</div>
                <div class="center">
                    <input type="text" id="extension-keyword" placeholder="Search">
                </div>
                <div class="icon">
                    <button id="open-extension-creator" data-tippy-content="Extension Creator">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button data-tippy-content="Close" class="close-dialog"><i class="fas fa-times"></i></button>
                    <div class="add-extension-box">
                        <form action="#" method="POST" id="form-add-extension">
                            <label for="extension-github-url">GitHug Repository URL</label>
                            <input type="url" id="extension-github-url" name="extension-github-url" autocomplete="off" placeholder="https://github.com/username/repository" required>
                            <button type="submit">Add Extension</button>
                            <button type="reset">Cancel</button>
                        </form>
                    </div>
                </div>
            </header>
            <section class="extension-work-box">
                <ul class="extension-category-list">
                    <li class="active">All</li>
                    <li>Display</li>
                    <li>Communication</li>
                    <li>Signal Input/Output</li>
                    <li>Sensors</li>
                    <li>Device Control</li>
                    <li>Timing</li>
                    <li>Data Storage</li>
                    <li>Data Processing</li>
                    <li>Other</li>
                    <li class="hr"></li>
                    <li>Installed</li>
                </ul>
                <ul class="extension-list">
                    <li>
                        <div class="extension-box" data-extension-id="1">
                            <div class="header">
                                <div class="cover">
                                    <img src="images/icon/led.png" alt="">
                                </div>
                                <div class="detail">
                                    <div class="name">MQTT<span class="installed-icon"><i class="fas fa-check-circle"></i></span></div>
                                    <div class="author">Sonthaya Nongnuch</div>
                                    <div class="other">
                                        <span class="version">1.0.0</span>
                                        <a href="https://www." target="_blank"><i class="fab fa-github"></i></a>
                                    </div>
                                </div>
                            </div>
                            <div class="description">Connect everything with MQTT</div>
                            <div class="button">
                                <button class="extension-install"><i class="fas fa-download"></i> Install</button>
                                <button class="extension-uninstall"><i class="fas fa-trash-alt"></i> Uninstall</button>
                            </div>
                        </div>
                    </li>
                </ul>
            </section>
        </div>

        <div class="dialog-tab" id="github-dialog">
            <section>
                <header>
                    <div class="title">Project hosted on GitHub<div class="close-btn"><i class="fas fa-times"></i></div></div>
                    <ul>
                        <li data-active="#github-dialog-open">Open Project</li>
                        <li data-active="#github-dialog-new">New Project</li>
                    </ul>
                </header>
                <section id="github-dialog-open">
                    <ul id="github-repository-list">

                    </ul>
                    <div class="control-button">
                        <button id="github-open-project-button">Open Project</button>
                    </div>
                </section>
                <section id="github-dialog-new">
                    <form action="" method="POST" id="form-github-create-project" autocomplete="off">
                        <label for="github-create-project-name">Project Name</label>
                        <input type="text" name="name" pattern="[A-Za-z0-9\-_]+" placeholder="GitHub repository name" required>
                        <label for="github-create-project-description">Project Description</label>
                        <input type="text" name="description" placeholder="GitHub repository description">
                        <label><input type="checkbox" name="save-code" value="1" checked> Save current code to new project</label>
                        <div class="control-button">
                            <button type="submit">Create Project</button>
                        </div>
                    </form>
                </section>
            </section>
        </div>

        <xml xmlns="https://developers.google.com/blockly/xml" id="toolbox" style="display: none">
            <category name="test">
                <block type="controls_if"></block>
                <block type="logic_compare"></block>
                <block type="controls_repeat_ext"></block>
                <block type="math_number">
                <field name="NUM">123</field>
                </block>
                <block type="math_arithmetic"></block>
                <block type="text"></block>
                <block type="text_print"></block>
            </category>
        </xml>

        <script>var require = { paths: { 'vs': 'monaco-editor/min/vs' } };</script>
        <script src="monaco-editor/min/vs/loader.js"></script>
	    <script src="monaco-editor/min/vs/editor/editor.main.nls.js"></script>
	    <script src="monaco-editor/min/vs/editor/editor.main.js"></script>

        <!-- Blocks -->
        <script src="blocks/blocks_pin.js"></script>
        <script src="blocks/blocks_controls.js"></script>
        <script src="blocks/blocks_operators.js"></script>
        <script src="blocks/blocks_variables.js"></script>
        <script src="blocks/blocks_advanced.js"></script>
        <script src="blocks/blocks_text_code.js"></script>

        <!-- Generators -->
        <script src="blocks/generators_pin.js"></script>
        <script src="blocks/generators_controls.js"></script>
        <script src="blocks/generators_avanced.js"></script>
        <script src="blocks/generators_text_code.js"></script>

        <!-- Python to Code converter -->
        <script src="js/code2block.js"></script>

        <script src="js/Notify.js"></script>

        <script src="js/Base64.js"></script>
        <script src="js/vFS.js"></script>
        <script src="js/GitHubAPI.js"></script>

        <script src="blocksTree.js"></script>
        <script src="js/mode.js"></script>
        <script src="js/serial.js"></script>
        <script src="js/terminal.js"></script>
        <script src="js/dialog.js"></script>
        <script src="js/extension.js"></script>

        <script src="js/install.js"></script>

        <script src="js/app.js"></script>
    </body>
</html>